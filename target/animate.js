!function(window){"use strict";var extend={easing:{linear:function(t,b,c,d){return c*t/d+b}}};var timelinePlayStack={},timelineCounter=0,intervalTimer=null,framesPerSecond=24;function addTimelineToPlayStack(timeline){timelinePlayStack[timelineCounter]=timeline;timelineCounter+=1}function removeTimelineFromPlayStack(uuid){timelinePlayStack[uuid].timelineReference=null;delete timelinePlayStack[uuid]}function initTimer(){function eachInterval(){var currentTime=timeNow(),uuid;for(uuid in timelinePlayStack){timelinePlayStack[uuid].update(currentTime)}}intervalTimer=setInterval(eachInterval,1e3/framesPerSecond)}function timeNow(){return+new Date}function animate(){return function(args){var uuid,timelineReference,playhead=0,lastPlayhead=timeNow(),uuid,actor=args[0],track=args[1],easeType=args[2]||"linear",onUpdateCallback,onEndCallback,framesArray=[],valuesArray=[],frame,i=0,l;for(frame in track){framesArray.push(parseFloat(frame))}framesArray.sort();l=framesArray.length;for(;i<l;i+=1){valuesArray.push(track[framesArray[i]])}track=[framesArray,valuesArray];function updateTime(){var frames=track[0],values=track[1],fromFrame=frames[0],fromValue=values[0],toFrame=frames[1],toValue=values[1],i=1,lastFrame=frames.length,returnValue;for(;i<lastFrame;i+=1){if(playhead>=frames[i]){fromFrame=frames[i];fromValue=values[i];toFrame=frames[i+1];toValue=values[i+1];if(i===lastFrame-1){toFrame=fromFrame;toValue=fromValue}}}returnValue=extend.easing[easeType](playhead-fromFrame,fromValue,toValue-fromValue,toFrame-fromFrame);if(onUpdateCallback){if(!isNaN(returnValue)){onUpdateCallback.call(timelineReference,actor,returnValue)}}if(onEndCallback){if(playhead>=frames[lastFrame-1]){removeTimelineFromPlayStack(uuid);onEndCallback.call(timelineReference,actor,returnValue)}}}return{play:function(){uuid=timelineCounter;addTimelineToPlayStack(this);timelineReference=timelinePlayStack[uuid];lastPlayhead=timeNow()},pause:function(){removeTimelineFromPlayStack(uuid);uuid=false},update:function(currentTime){if(uuid!==false){playhead+=(currentTime-lastPlayhead)/1e3;updateTime();lastPlayhead=currentTime}},restart:function(){uuid=timelineCounter;playhead=0;lastPlayhead=timeNow();addTimelineToPlayStack(this)},onUpdate:function(cb){onUpdateCallback=cb;return this},onEnd:function(cb){onEndCallback=cb;return this},extend:function(ref,obj){for(var key in obj){extend[ref][key]=obj[key]}},stopAll:function(){for(uuid in timelinePlayStack){timelinePlayStack[uuid].pause()}}}}(arguments)}initTimer();window.animate=animate}(this);